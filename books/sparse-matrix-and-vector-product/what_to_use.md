---
title: 疎行列はどこから生まれ何に使われるのか
---

# 前置き
私の興味は，何らかの自然科学を解析することではなく，
行列とベクトルを与えられた際，それらに対する連立一次方程式や固有値問題を確実に，かつ高速に解くソフトウェアを作ることです．

私の理想は全ての問題に対する汎用的なソフトウェア開発であり，
特定の問題には全く興味がありません．
そのため，行列がどうやって出来るのかにもあまり興味がありません．

一応，教養として勉強はしたので，同じような情報系の人向けに簡単に書きますが，
本章についてはそれぞれの解析対象に関する書籍を読んだほうが良いと思います．

# 疎行列はどこから生まれ何に使われるのか (未執筆)

疎行列は神から与えられます (未執筆)．

行列なんで，用途なんていくらでも考えられるわけですが，この本では連立一次方程式や固有値問題を解くために使われることを想定します．

物理シミュレーションの核は物理現象を記述する偏微分方程式などを差分法や有限要素法などを用いて離散化することによって得られる疎行列を係数行列とする連立一次方程式の求解である．
疎行列は解析領域を格子分割するなどによって得られる．
解析領域を細かく分割することによって離散化誤差を減らし精度の高いシミュレーションを行えるが，行列のサイズは大きくなり求解にかかる時間が増大する．

一般的に離散化により得られる疎行列は格子点数に依存した次元数および各格子点の節点間の接続に依存した非零要素をもつ．
解析領域を細かく分割しても接続関係は大きく変わらないため1行あたりの非零要素数はほとんど変化せず，大規模なシミュレーションでは非常に疎な行列が現れる．
そのため一般的に疎行列の表現にはメモリ使用量を節約するために行番号や列番号のインデックス配列を用いて零要素を記憶しない格納形式を用いる．
疎行列を係数とする連立一次方程式解法では疎行列の値の書き換えや挿入が頻繁に行われるLU分解などの直接解法でなく反復解法がよく使われる．

連立一次方程式$Ax = b$ に対するKrylov部分空間法は，
初期近似解$ x_0 $ に対応する初期残差ベクトル$ r_0  = b - Ax_0 $ を用いて
$ A $ のべき乗と$r_0$ の積の像が張る空間から近似解を探索する反復法アルゴリズムの一つのカテゴリで，
行列の性質に応じて様々なアルゴリズムがある．
行列をベクトルに作用させ，ベクトルの更新を繰り返すことで近似解をえる．
ベクトルのみを更新するため疎行列を変更する必要がなく疎行列を扱いやすい．
